
[agent]
  interval = "1s"
  flush_interval = "1s"
  precision = "1s"
  debug = true
  quiet = false

[[inputs.kafka_consumer]]
  brokers = ["kafka:9092"]
  topics = ["gnmi_data"]
  offset = "newest"
  data_format = "json"
  
  # Set measurement name
  name_override = "network_interface"
  
  # Extract tags from top-level fields
  tag_keys = ["hostname", "interface_name", "ip"]
  
  # Parse the nested interface_data object
  json_query = "interface_data"
  
  # Define which fields should remain as strings (non-numeric values)
  json_string_fields = [
    "admin_state",
    "oper_state", 
    "last_change",
    "loopback_mode",
    "forwarding_mode",
    "port_speed",
    "hw_mac_address",
    "oper_down_reason",
    "type",
    "name",
    "ip_prefix",
    "origin",
    "status",
    "link_layer_address",
    "expiration_time"
  ]

[[outputs.influxdb_v2]]
  urls = ["http://influxdb:8086"]
  token = "mytoken"
  organization = "myorg"
  bucket = "infldb"

